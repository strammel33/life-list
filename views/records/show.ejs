<%- include('../partials/html-head') %>
<link rel="stylesheet" href="/stylesheets/records/forms.css" />
<%- include('../partials/nav') %>

<main>
  <div class="left">
    <% if (user) { %>
      <h2><%= title %></h2>
      <h3><%= record.title %></h3>
      <h4><%= record.date %></h4>
      <p> <%= record.description %></p>
      <% if (record.owner.equals(user?.profile._id)) { %>
        <a href="/records/<%= record._id %>/edit">
          <button class="btn">Edit Record</button>
        </a>
        <a href="/records/<%= record._id %>/delete">
          <button class="btn" type="submit">Delete Record</button>
        </a>
      <% } else { %>
        <h2>This is Ill-Eagle.</h2>
      <% } %>
    <% } %>
  </div>
  <div class="right">
    <h2>Species Seen:</h2>
    <ul>
      <% record.birds.forEach((bird) => { %>
        <li>
          <a href="/birds/<%= bird._id %>"><%= bird.name %></a> 
          <% if (record.owner.equals(user?.profile._id)) { %>
            - 
            <form action="/records/<%= record._id %>/birds/<%= bird._id %>?_method=DELETE" method="POST">
              <button type="submit">X</button>
            </form>
          <% } else { %>
          <% } %>
        </li>
      <% }) %>
    </ul>
    <section>
      <% if (record.owner.equals(user?.profile._id)) { %>
        <form id="add-bird-to-record" action="/records/<%= record._id %>/birds" method="POST">
          <select name="birdId">
            <% birds.forEach(bird => { %>
              <option value="<%= bird._id %>"><%= bird.name %></option>
            <% }) %>
          </select>
          <button type="submit">Add to Record</button>
        </form>
      <% } else { %>
      <% } %>
    </section>
  </div>
</main>
<section class="space">

</section>

<%- include('../partials/footer') %>